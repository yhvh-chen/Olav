{
  "id": "bgp_peer_audit",
  "name": "bgp_peer_audit",
  "description": "Verify BGP peer counts and states across edge routers",
  "filename": "bgp_peer_audit.yaml",
  "devices": [
    "R1",
    "R2",
    "R3",
    "R2"
  ],
  "checks": [
    {
      "name": "bgp_established_count",
      "description": "Ensure at least 2 BGP peers are Established",
      "tool": "suzieq_query",
      "enabled": true,
      "parameters": {
        "table": "bgp",
        "state": "Established",
        "method": "get"
      }
    },
    {
      "name": "bgp_no_idle_peers",
      "description": "No BGP peers should be in Idle state",
      "tool": "suzieq_query",
      "enabled": true,
      "parameters": {
        "table": "bgp",
        "state": "Idle",
        "method": "get"
      }
    },
    {
      "name": "bgp_session_stability",
      "description": "BGP sessions should have reasonable uptime (>1 hour)",
      "tool": "suzieq_query",
      "enabled": false,
      "parameters": {
        "table": "bgp",
        "state": "Established",
        "method": "get"
      }
    }
  ],
  "parallel": true,
  "max_workers": 5,
  "stop_on_failure": false,
  "output_format": "table"
}