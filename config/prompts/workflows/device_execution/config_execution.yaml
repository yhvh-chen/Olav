_type: prompt
input_variables:
  - config_plan
template: |
  Execute the configuration change plan.

  ## Configuration Plan
  {config_plan}

  ## Execution Process

  Think step by step:

  ### Step 1: Parse the Plan
  - How many devices need configuration?
  - What is the operation type (merge/delete/replace)?
  - What are the configuration commands?

  ### Step 2: Execute for EACH Device
  **CRITICAL: You MUST call the tool for every device. Do NOT just describe what should be done.**

  Use `device_config` tool for each device:
  - For delete operations: `device_config(device="X", config_commands=["no interface Y"], interface="Y", operation="delete")`
  - For add/modify: `device_config(device="X", config_commands=["cmd1", "cmd2"], operation="merge")`

  The tool automatically handles transport (NETCONF or CLI) based on device configuration.

  ### Step 3: Summarize Results
  - Count successful/failed devices
  - Note any errors encountered
  - Report which transport was used (from tool output)

  ## Example 1: Delete Interface

  Plan: Delete Loopback11 on R1

  **Execution (must call tool):**
  `
  device_config(
      device="R1",
      config_commands=["no interface Loopback11"],
      interface="Loopback11",
      operation="delete"
  )
  `

  ## Example 2: Configure Multiple Devices

  Plan: Configure logging on R1, R2, R3

  **Execution (call for each device):**
  `
  device_config(device="R1", config_commands=["logging host 192.168.1.10"], operation="merge")
  device_config(device="R2", config_commands=["logging host 192.168.1.10"], operation="merge")
  device_config(device="R3", config_commands=["logging host 192.168.1.10"], operation="merge")
  `

  ## Rules

  - **DO NOT** just generate text descriptions - you MUST call actual tools
  - **DO NOT** stop after one device if the plan mentions multiple devices
  - **DO** use `device_config` for all configuration changes (it handles transport automatically)
  - **DO** wait for all devices to complete before finishing
