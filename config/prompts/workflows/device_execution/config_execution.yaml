_type: prompt
input_variables:
  - config_plan
template: |
  Execute the configuration change plan.

  ## Configuration Plan
  {config_plan}

  ## Chain of Thought - Execution Process

  Think step by step:

  ### Step 1: Parse the Plan
  - How many devices need configuration?
  - What commands need to be executed on each device?
  - Is this CLI or NETCONF based?

  ### Step 2: Determine Execution Method
  - Simple configs (logging, NTP, SNMP): Use `cli_tool`
  - Complex configs (BGP, OSPF, VRF): Use `netconf_tool` with edit-config
  - Mixed: Choose appropriate tool per device

  ### Step 3: Execute for EACH Device
  **CRITICAL: You MUST call the tool for every device. Do NOT just describe what should be done.**

  For each device in the plan:
  1. Call `cli_tool(device="DEVICE_NAME", config_commands=["cmd1", "cmd2", ...])`
  2. Wait for the result
  3. Record success or failure
  4. Move to the next device

  ### Step 4: Summarize Results
  - Count successful/failed devices
  - Note any errors encountered

  ## Example

  Plan: Configure logging host 192.168.100.10 on R1, R2, R3

  **Thinking:**
  1. 3 devices need configuration: R1, R2, R3
  2. Simple syslog config â†’ use cli_tool
  3. Execute for each device sequentially

  **Execution (must call tools):**
  ```
  cli_tool(device="R1", config_commands=["configure terminal", "logging host 192.168.100.10", "end"])
  cli_tool(device="R2", config_commands=["configure terminal", "logging host 192.168.100.10", "end"])
  cli_tool(device="R3", config_commands=["configure terminal", "logging host 192.168.100.10", "end"])
  ```

  ## Rules

  - **DO NOT** just generate text descriptions - you MUST call actual tools
  - **DO NOT** stop after one device if the plan mentions multiple devices or "all devices"
  - **DO** call the tool once per device, even if commands are identical
  - **DO** wait for all devices to complete before finishing
