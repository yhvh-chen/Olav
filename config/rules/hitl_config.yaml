# HITL (Human-in-the-Loop) Configuration
#
# Defines which tools and operations require human approval.
# This replaces hardcoded tool lists in main.py

# Tools that require HITL approval before execution
# These perform write operations or access sensitive resources
hitl_required_tools:
  - cli_tool          # SSH CLI commands (write capable)
  - netconf_tool      # NETCONF RPC (edit-config capable)
  - nornir_tool       # Nornir tasks (write capable)
  - netbox_api_call   # NetBox API mutations

# Tools that are always safe (read-only)
safe_tools:
  - suzieq_query           # Read-only Parquet queries
  - suzieq_schema_search   # Schema discovery
  - search_episodic_memory # Memory search
  - search_openconfig_schema  # OpenConfig schema search
  - netbox_schema_search   # NetBox schema discovery
  - search_documents       # Document RAG search
  - search_vendor_docs     # Vendor doc search
  - search_rfc            # RFC search
  - datetime_tool         # Current datetime

# Operation-based HITL rules (more granular than tool-based)
operation_rules:
  # Always require HITL regardless of tool
  always_require:
    - delete
    - remove
    - shutdown
    - disable
    - edit-config
    - configure
  
  # Never require HITL
  never_require:
    - get
    - show
    - query
    - search
    - list
    - describe

# HITL approval settings
approval_settings:
  # Timeout for waiting for human approval (seconds)
  timeout: 300
  
  # Auto-reject if timeout
  auto_reject_on_timeout: true
  
  # Allow batch approval for multiple similar operations
  batch_approval: true
  
  # Maximum operations in a batch approval
  max_batch_size: 10

# Bypass rules (for automation/CI scenarios)
bypass_rules:
  # Environment variable to bypass HITL (use with caution)
  env_variable: OLAV_HITL_BYPASS
  
  # Allowed bypass contexts
  allowed_contexts:
    - dry_run
    - test_mode
    - ci_pipeline
  
  # Never bypass these operations even with bypass enabled
  never_bypass:
    - delete
    - shutdown
    - remove
