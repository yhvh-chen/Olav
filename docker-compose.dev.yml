# Development override for docker-compose
# Usage: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

services:
  olav-server:
    build:
      context: .
      dockerfile: Dockerfile.server
    volumes:
      # Mount source code for hot reload
      - ./src:/app/src:ro
      - ./config:/app/config:ro
      - ./scripts:/app/scripts:ro
    environment:
      ENVIRONMENT: development
      LOG_LEVEL: DEBUG
    command: ["uv", "run", "uvicorn", "olav.server.app:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]

  olav-tests:
    volumes:
      # Mount tests for easier development
      - ./tests:/app/tests:ro
      - ./src:/app/src:ro
    command: ["pytest", "tests/e2e/", "-v", "--tb=short", "-x"]
