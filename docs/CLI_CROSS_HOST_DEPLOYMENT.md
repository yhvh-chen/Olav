# OLAV CLI è·¨ä¸»æœºéƒ¨ç½²åˆ†æ

## ğŸ¯ æ ¸å¿ƒé—®é¢˜

**é—®é¢˜**: å¦‚æœç”¨æˆ·åªæ‹·è´ CLI åˆ°å…¶å®ƒä¸»æœºä¸Šè¿æ¥ï¼Œè¿˜éœ€è¦æ‹·è´ .env æ–‡ä»¶å—ï¼Ÿ

**ç­”æ¡ˆ**: âŒ **ä¸éœ€è¦ï¼ä½†éœ€è¦é…ç½®è¿æ¥ä¿¡æ¯ã€‚**

---

## ğŸ“ Client Token å­˜å‚¨ä½ç½®

### å­˜å‚¨ä½ç½®æ€»è§ˆ

| æ•°æ®ç±»å‹ | å­˜å‚¨ä½ç½® | ä½œç”¨åŸŸ | å¿…éœ€æ€§ |
|---------|---------|--------|--------|
| **Session Token** | `~/.olav/credentials` | **ç”¨æˆ·çº§åˆ«** | âœ… CLI è¿æ¥å¿…éœ€ |
| **Server URL** | `~/.olav/config.toml` | **ç”¨æˆ·çº§åˆ«** | å¯é€‰ï¼ˆé»˜è®¤ localhostï¼‰ |
| **Master Token** | `.env` æ–‡ä»¶ | **é¡¹ç›®çº§åˆ«** | âŒ CLI **ä¸éœ€è¦** |
| **LLM API Key** | `.env` æ–‡ä»¶ | **é¡¹ç›®çº§åˆ«** | âŒ CLI **ä¸éœ€è¦** |

### è¯¦ç»†è¯´æ˜

#### 1. Session Token å­˜å‚¨ (`~/.olav/credentials`)

**ä½ç½®**: 
```bash
# Linux/Mac
~/.olav/credentials

# Windows
C:\Users\{username}\.olav\credentials
```

**å†…å®¹æ ¼å¼**:
```ini
# OLAV Client Credentials
# Auto-generated by 'olav register'

OLAV_SESSION_TOKEN=abc123xyz789...
OLAV_CLIENT_ID=550e8400-e29b-41d4-a716-446655440000
OLAV_CLIENT_NAME=alice-laptop
```

**ç”Ÿæˆæ–¹å¼**:
```bash
olav register --name "my-laptop" --token "<master-token-from-server>"
```

**æƒé™**: 
- Unix: è‡ªåŠ¨è®¾ç½®ä¸º `0600` (ç”¨æˆ·ç‹¬å )
- Windows: ç»§æ‰¿ç”¨æˆ·ç›®å½•æƒé™

#### 2. Server é…ç½® (`~/.olav/config.toml`)

**ä½ç½®**:
```bash
~/.olav/config.toml
```

**å†…å®¹æ ¼å¼** (TOML):
```toml
[server]
url = "http://192.168.1.100:8001"  # è¿œç¨‹ server åœ°å€
timeout = 300
```

**å¯é€‰æ€§**: å¦‚æœä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤å€¼ `http://localhost:8001`ï¼ˆä¹Ÿå¯ä»¥åœ¨é¦–æ¬¡ `olav register --server ...` æ—¶è‡ªåŠ¨å†™å…¥ï¼‰

#### 3. .env æ–‡ä»¶ï¼ˆé¡¹ç›®çº§åˆ«ï¼‰

**ä½ç½®**: é¡¹ç›®æ ¹ç›®å½• `./env`

**å†…å®¹** (ä»… Server éœ€è¦):
```dotenv
# LLM Configuration (Server ç”¨)
LLM_API_KEY=sk-...
LLM_MODEL_NAME=gpt-4

# Server Authentication (Server ç”¨)
OLAV_API_TOKEN=<master-token>
AUTH_DISABLED=false

# Database (Server ç”¨)
POSTGRES_URI=...
OPENSEARCH_URL=...
```

**CLI æ˜¯å¦éœ€è¦**: âŒ **å®Œå…¨ä¸éœ€è¦**

---

## ğŸ” Token æŸ¥æ‰¾ä¼˜å…ˆçº§

**æºä»£ç **: `src/olav/cli/commands.py` lines 78-113

```python
def _get_config_from_env(server_url: str | None = None):
    # Token æŸ¥æ‰¾ä¼˜å…ˆçº§:
    auth_token = (
        os.getenv("OLAV_API_TOKEN")               # 1ï¸âƒ£ ç¯å¢ƒå˜é‡ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
        or env_vars.get("OLAV_API_TOKEN")         # 2ï¸âƒ£ .env æ–‡ä»¶ï¼ˆé¡¹ç›®çº§ï¼‰
        or credentials.get("OLAV_SESSION_TOKEN")  # 3ï¸âƒ£ ~/.olav/credentialsï¼ˆç”¨æˆ·çº§ï¼‰
    )
```

### ä¼˜å…ˆçº§è¯¦è§£

| ä¼˜å…ˆçº§ | æ¥æº | ç”¨é€” | è·¨ä¸»æœºå¯ç”¨æ€§ |
|--------|------|------|-------------|
| **1** | `$env:OLAV_API_TOKEN` | ä¸´æ—¶è¦†ç›–/æµ‹è¯• | âŒ ä¼šè¯çº§åˆ« |
| **2** | `.env` ä¸­çš„ `OLAV_API_TOKEN` | é¡¹ç›®çº§é…ç½® | âŒ éœ€æ‹·è´ .env |
| **3** | `~/.olav/credentials` | ç”¨æˆ·æ³¨å†Œåçš„ token | âœ… **è·¨ä¸»æœºå¯ç”¨** |

**å…³é”®å‘ç°**:
- âœ… ä¼˜å…ˆçº§ 3ï¼ˆ`~/.olav/credentials`ï¼‰æ˜¯**ç”¨æˆ·çº§åˆ«**ï¼Œéšç”¨æˆ·è¿ç§»
- âŒ ä¼˜å…ˆçº§ 1 å’Œ 2 æ˜¯**é¡¹ç›®çº§åˆ«**æˆ–**ä¼šè¯çº§åˆ«**ï¼Œä¸åº”è·¨ä¸»æœºæ‹·è´

---

## ğŸ“¦ CLI è·¨ä¸»æœºéƒ¨ç½²åœºæ™¯åˆ†æ

### Scenario 1: æ‹·è´æ•´ä¸ªé¡¹ç›®ï¼ˆâŒ ä¸æ¨èï¼‰

```bash
# ä¸»æœº A (Server æ‰€åœ¨æœºå™¨)
scp -r /path/to/Olav user@host-b:/path/to/

# ä¸»æœº B (Client)
cd /path/to/Olav
uv run cli.py query "show interfaces"
```

**é—®é¢˜**:
1. âŒ æ‹·è´äº†æ•´ä¸ªé¡¹ç›®ï¼ˆåŒ…æ‹¬ `src/`, `data/`, `.env`ï¼‰
2. âŒ `.env` åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆLLM API Key, DBå¯†ç ï¼‰
3. âŒ ä½“ç§¯å¤§ï¼ˆåŒ…å« server ä»£ç å’Œæ•°æ®ï¼‰
4. âŒ `.env` ä¸­çš„é…ç½®æ˜¯ Server ç”¨çš„ï¼ŒClient ä¸éœ€è¦

**ç»“è®º**: **ä¸åˆç†**

---

### Scenario 2: åªæ‹·è´ CLI æ–‡ä»¶ï¼ˆâœ… æ¨èï¼‰

```bash
# ä¸»æœº A - å‡†å¤‡ CLI ç‹¬ç«‹åŒ…
mkdir olav-cli
cp cli.py olav-cli/
cp -r src/olav/cli olav-cli/src/olav/
cp pyproject.toml olav-cli/  # ç”¨äº uv å®‰è£…ä¾èµ–

# æ‹·è´åˆ°ä¸»æœº B
scp -r olav-cli user@host-b:/home/user/

# ä¸»æœº B - é…ç½®å’Œä½¿ç”¨
cd olav-cli
uv sync  # å®‰è£…ä¾èµ–

# é…ç½® Server åœ°å€
mkdir -p ~/.olav
cat > ~/.olav/config.toml << EOF
[server]
url = "http://192.168.1.100:8001"  # Server çš„çœŸå® IP
timeout = 300
EOF

# æ³¨å†Œ Client
uv run cli.py register --name "host-b-client" --token "<ä» Server æ—¥å¿—è·å–çš„ master token>"

# ä½¿ç”¨ CLI
uv run cli.py query "show interfaces"
```

**ä¼˜ç‚¹**:
1. âœ… åªæ‹·è´å¿…è¦æ–‡ä»¶ï¼ˆCLI ä»£ç ï¼‰
2. âœ… æ— éœ€ `.env` æ–‡ä»¶
3. âœ… æ— æ•æ„Ÿä¿¡æ¯æ³„éœ²
4. âœ… ä½“ç§¯å°ï¼ˆä»… CLI ä¾èµ–ï¼‰
5. âœ… `~/.olav/credentials` è‡ªåŠ¨ç”Ÿæˆ

**ç»“è®º**: **åˆç†ä¸”å®‰å…¨**

---

### Scenario 3: ä½¿ç”¨é¢„æ‰“åŒ…çš„ CLIï¼ˆğŸ¯ æœ€ä½³å®è·µï¼‰

**ç†æƒ³æ–¹æ¡ˆ**: æä¾›ç‹¬ç«‹çš„ CLI å®‰è£…åŒ…

```bash
# æ–¹æ¡ˆ A: PyPI å®‰è£…ï¼ˆå¦‚æœå‘å¸ƒåˆ° PyPIï¼‰
pip install olav-cli
olav config set server-url http://server-ip:8001
olav register --name "my-client" --token "<master-token>"
olav query "show interfaces"

# æ–¹æ¡ˆ B: å•æ–‡ä»¶å¯æ‰§è¡Œç¨‹åºï¼ˆä½¿ç”¨ PyInstallerï¼‰
wget https://releases.olav.io/olav-cli-linux-x64
chmod +x olav-cli-linux-x64
./olav-cli-linux-x64 config set server-url http://server-ip:8001
./olav-cli-linux-x64 register --name "my-client" --token "<master-token>"
./olav-cli-linux-x64 query "show interfaces"
```

**ä¼˜ç‚¹**:
- âœ… é›¶é…ç½®æ–‡ä»¶ä¾èµ–
- âœ… ä¸€é”®å®‰è£…
- âœ… æ‰€æœ‰é…ç½®å­˜å‚¨åœ¨ `~/.olav/`
- âœ… ç¬¦åˆ Unix å“²å­¦

---

## ğŸ” æ‹·è´ .env çš„å®‰å…¨é—®é¢˜

### .env åŒ…å«çš„æ•æ„Ÿä¿¡æ¯

```dotenv
# âŒ ä¸åº”è¯¥æ‹·è´åˆ° Client ä¸»æœº
LLM_API_KEY=sk-xxxxxxxxxxxxxxxx           # ğŸ’° è®¡è´¹å¯†é’¥
POSTGRES_PASSWORD=OlavPG123!               # ğŸ” æ•°æ®åº“å¯†ç 
NETBOX_TOKEN=0123456789abcdef...           # ğŸ”‘ NetBox API
NETBOX_SUPERUSER_PASSWORD=admin            # ğŸ”‘ ç®¡ç†å‘˜å¯†ç 
OPENSEARCH_PASSWORD=OlavOS123!             # ğŸ” æœç´¢å¼•æ“å¯†ç 
OLAV_API_TOKEN=<master-token>              # ğŸ” Server ä¸»å¯†é’¥
```

### é£é™©åˆ†æ

| é£é™© | å½±å“ | å‘ç”Ÿæ¦‚ç‡ |
|------|------|---------|
| **API Key æ³„éœ²** | LLM è´¹ç”¨ç›—åˆ· | é«˜ï¼ˆå¦‚æœ .env è¢«æäº¤åˆ° Gitï¼‰ |
| **æ•°æ®åº“å¯†ç æ³„éœ²** | æ•°æ®è¢«ç¯¡æ”¹/åˆ é™¤ | ä¸­ï¼ˆå¦‚æœä¸»æœºè¢«å…¥ä¾µï¼‰ |
| **Master Token æ³„éœ²** | ä»»æ„ Client æ³¨å†Œ | é«˜ï¼ˆToken æœ‰æ•ˆæœŸ 24 å°æ—¶ï¼‰ |

### æœ€ä½³å®è·µ

```bash
# âœ… Server ä¸»æœº (.env)
LLM_API_KEY=sk-real-key
POSTGRES_PASSWORD=complex-password
OLAV_API_TOKEN=server-master-token

# âœ… Client ä¸»æœº (æ— éœ€ .env)
# æ‰€æœ‰é…ç½®åœ¨ ~/.olav/ ç›®å½•ä¸‹
~/.olav/config.toml    # Server URL
~/.olav/credentials    # Session Token
```

---

## ğŸ› ï¸ CLI éƒ¨ç½²æœ€ä½³å®è·µ

### æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | .env éœ€æ±‚ | å®‰å…¨æ€§ | ä¾¿åˆ©æ€§ | æ¨èåº¦ |
|------|----------|--------|--------|--------|
| **æ‹·è´æ•´ä¸ªé¡¹ç›®** | âœ… åŒ…å« | âŒ ä½ | â­â­ | âŒ ä¸æ¨è |
| **åªæ‹·è´ CLI æ–‡ä»¶** | âŒ ä¸éœ€è¦ | âœ… é«˜ | â­â­â­ | âœ… æ¨è |
| **PyPI å®‰è£…** | âŒ ä¸éœ€è¦ | âœ… é«˜ | â­â­â­â­â­ | ğŸ¯ æœ€ä½³ |
| **å•æ–‡ä»¶å¯æ‰§è¡Œ** | âŒ ä¸éœ€è¦ | âœ… é«˜ | â­â­â­â­ | ğŸ¯ æœ€ä½³ |

### æ¨èæµç¨‹

#### Step 1: Server ç«¯å‡†å¤‡

```bash
# Server ä¸»æœº - å¯åŠ¨æœåŠ¡
cd /path/to/Olav
docker-compose up -d olav-server

# æŸ¥çœ‹ Master Token
docker logs olav-server | grep "ACCESS TOKEN"
# è¾“å‡º: ğŸ”‘ ACCESS TOKEN: abc123xyz789...
```

#### Step 2: Client ç«¯éƒ¨ç½²

**é€‰é¡¹ A: ä»…æ‹·è´ CLI ä»£ç **
```bash
# å‡†å¤‡ CLI åŒ…ï¼ˆServer ä¸»æœºæ‰§è¡Œï¼‰
mkdir olav-cli-package
cp cli.py olav-cli-package/
cp -r src/olav/cli olav-cli-package/src/olav/
cp pyproject.toml olav-cli-package/

# ä¼ è¾“åˆ° Client ä¸»æœº
scp -r olav-cli-package user@client-host:/opt/olav-cli

# Client ä¸»æœºé…ç½®
cd /opt/olav-cli
uv sync
```

**é€‰é¡¹ B: Git Clone + Sparse Checkout**
```bash
# Client ä¸»æœº
git clone --filter=blob:none --sparse https://github.com/your/olav.git
cd olav
git sparse-checkout set cli.py src/olav/cli pyproject.toml
uv sync
```

#### Step 3: é…ç½® Server è¿æ¥

```bash
# Client ä¸»æœº
mkdir -p ~/.olav

# é…ç½® Server URL
cat > ~/.olav/config.toml << EOF
[server]
url = "http://192.168.1.100:8001"  # æ›¿æ¢ä¸ºå®é™… Server IP
timeout = 300
EOF
```

#### Step 4: æ³¨å†Œ Client

```bash
# Client ä¸»æœº
uv run cli.py register \
  --name "$(hostname)-client" \
  --token "abc123xyz789..."  # ä» Server æ—¥å¿—è·å–

# è¾“å‡º:
# âœ… Registration successful!
#    Client ID: 550e8400-e29b-41d4-a716-446655440000
#    Credentials saved to ~/.olav/credentials
```

#### Step 5: ä½¿ç”¨ CLI

```bash
# Client ä¸»æœº - è‡ªåŠ¨ä½¿ç”¨ ~/.olav/credentials ä¸­çš„ token
uv run cli.py query "show interfaces"
uv run cli.py query "æ£€æŸ¥ BGP çŠ¶æ€"
```

---

## ğŸ“Š æ–‡ä»¶ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Server ä¸»æœº                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  ğŸ“ /path/to/Olav/                                  â”‚
â”‚  â”œâ”€â”€ .env  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” Server éœ€è¦      â”‚
â”‚  â”‚   â””â”€â”€ LLM_API_KEY            â”‚                   â”‚
â”‚  â”‚   â””â”€â”€ POSTGRES_PASSWORD      â”‚ âŒ Client ä¸éœ€è¦  â”‚
â”‚  â”‚   â””â”€â”€ OLAV_API_TOKEN         â”‚                   â”‚
â”‚  â”‚                               â”‚                   â”‚
â”‚  â”œâ”€â”€ docker-compose.yml          â”‚                   â”‚
â”‚  â”œâ”€â”€ src/olav/server/  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚  â””â”€â”€ src/olav/cli/  (å¯é€‰æ‹·è´ç»™ Client)             â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ HTTP/SSE
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Client ä¸»æœº                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  ğŸ“ /opt/olav-cli/                                  â”‚
â”‚  â”œâ”€â”€ cli.py                                         â”‚
â”‚  â”œâ”€â”€ src/olav/cli/                                  â”‚
â”‚  â””â”€â”€ pyproject.toml                                 â”‚
â”‚                                                      â”‚
â”‚  ğŸ“ ~/.olav/  (ç”¨æˆ·çº§é…ç½®)  âœ… çœŸæ­£éœ€è¦çš„            â”‚
â”‚  â”œâ”€â”€ config.toml  â†â”€â”€ Server URL                    â”‚
â”‚  â””â”€â”€ credentials  â†â”€â”€ Session Token (æ³¨å†Œåç”Ÿæˆ)     â”‚
â”‚                                                      â”‚
â”‚  ğŸ“ .env  âŒ å®Œå…¨ä¸éœ€è¦ï¼                            â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ç»“è®ºä¸å»ºè®®

### âŒ ä¸åº”è¯¥æ‹·è´ .env çš„ç†ç”±

1. **å®‰å…¨é£é™©**: åŒ…å« LLM API Keyã€æ•°æ®åº“å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯
2. **æ— å¿…è¦æ€§**: CLI åªéœ€è¦ Server URL å’Œ Session Token
3. **é…ç½®æ··æ·†**: .env æ˜¯ Server çš„é…ç½®ï¼Œä¸æ˜¯ Client çš„
4. **ç»´æŠ¤å›°éš¾**: å¤šä¸ª Client å…±äº« .env å¯¼è‡´é…ç½®å†²çª

### âœ… æ­£ç¡®çš„è·¨ä¸»æœºéƒ¨ç½²æ–¹æ¡ˆ

```bash
# éœ€è¦çš„æ–‡ä»¶/é…ç½®ï¼š
~/.olav/config.toml    # Server URLï¼ˆå¯é€‰ï¼Œé»˜è®¤ localhostï¼‰
~/.olav/credentials    # Session Tokenï¼ˆæ³¨å†Œåè‡ªåŠ¨ç”Ÿæˆï¼‰

# ä¸éœ€è¦çš„æ–‡ä»¶ï¼š
.env                   # Server é…ç½®æ–‡ä»¶ âŒ
config/                # Server é…ç½®ç›®å½• âŒ
data/                  # Server æ•°æ®ç›®å½• âŒ
```

### ğŸ“ æ¨èéƒ¨ç½²æ¸…å•

**Server ä¸»æœº**:
- âœ… å®Œæ•´çš„ OLAV é¡¹ç›®ï¼ˆå« .envï¼‰
- âœ… Docker Compose å¯åŠ¨ server
- âœ… è®°å½• Master Tokenï¼ˆä»æ—¥å¿—ï¼‰

**Client ä¸»æœº**:
- âœ… ä»… CLI ä»£ç ï¼ˆ`cli.py` + `src/olav/cli/`ï¼‰
- âœ… `~/.olav/config.toml`ï¼ˆé…ç½® Server URLï¼‰
- âœ… `~/.olav/credentials`ï¼ˆæ³¨å†Œåè‡ªåŠ¨ç”Ÿæˆï¼‰
- âŒ **ä¸éœ€è¦ .env æ–‡ä»¶**

### ğŸš€ æœªæ¥æ”¹è¿›å»ºè®®

1. **æä¾›ç‹¬ç«‹ CLI åŒ…**: å‘å¸ƒåˆ° PyPI (`pip install olav-cli`)
2. **å•æ–‡ä»¶å¯æ‰§è¡Œ**: ä½¿ç”¨ PyInstaller æ‰“åŒ…
3. **é…ç½®å‘½ä»¤**: `olav config set server-url <url>`
4. **è‡ªåŠ¨å‘ç°**: mDNS è‡ªåŠ¨å‘ç°å±€åŸŸç½‘ Server
5. **Token ç®¡ç†**: `olav token renew` è‡ªåŠ¨åˆ·æ–°è¿‡æœŸ token

---

## ğŸ” éªŒè¯æµ‹è¯•

### æµ‹è¯• 1: æ—  .env æ–‡ä»¶è¿è¡Œ CLI

```bash
# Client ä¸»æœºï¼ˆåˆ é™¤ .envï¼‰
rm -f .env

# é…ç½® Server URL
cat > ~/.olav/config.toml << EOF
[server]
url = "http://192.168.1.100:8001"
EOF

# æ³¨å†Œ
uv run cli.py register --name "test-client" --token "abc123"

# éªŒè¯
uv run cli.py query "test"
# âœ… åº”è¯¥æˆåŠŸï¼ˆè¯æ˜ä¸éœ€è¦ .envï¼‰
```

### æµ‹è¯• 2: è·¨ä¸»æœºè¿æ¥

```bash
# ä¸»æœº A (Server)
docker logs olav-server | grep "ACCESS TOKEN"
# å¤åˆ¶ token

# ä¸»æœº B (Client)
# ä»…æ‹·è´ CLI æ–‡ä»¶ï¼Œæ—  .env
scp -r server-a:/path/to/Olav/src/olav/cli ./
scp server-a:/path/to/Olav/cli.py ./

# é…ç½®å’Œæ³¨å†Œ
mkdir -p ~/.olav
echo '[server]\nurl = "http://server-a:8001"' > ~/.olav/config.toml
uv run cli.py register --name "host-b" --token "<paste-token>"

# æµ‹è¯•
uv run cli.py query "show version"
# âœ… åº”è¯¥æˆåŠŸ
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `docs/AUTHENTICATION_GUIDE.md` - è®¤è¯æœºåˆ¶è¯¦è§£
- `src/olav/cli/commands.py` - CLI å‘½ä»¤å®ç°
- `src/olav/cli/thin_client.py` - HTTP Client å®ç°
- `cli.py` - CLI å…¥å£ç‚¹

---

## ğŸ“ å…³é”®è¦ç‚¹æ€»ç»“

| é—®é¢˜ | ç­”æ¡ˆ |
|------|------|
| **Client Token å­˜å‚¨ä½ç½®** | `~/.olav/credentials` (ç”¨æˆ·çº§åˆ«) |
| **æ˜¯å¦éœ€è¦æ‹·è´ .env** | âŒ **ä¸éœ€è¦** |
| **.env çš„ä½œç”¨åŸŸ** | Server ç«¯ï¼ˆLLMã€DBã€Auth é…ç½®ï¼‰ |
| **CLI çœŸæ­£éœ€è¦çš„** | Server URL + Session Token |
| **è·¨ä¸»æœºéƒ¨ç½²æ–¹æ¡ˆ** | ä»…æ‹·è´ CLI ä»£ç  + é…ç½® `~/.olav/` |
| **å®‰å…¨æ€§** | .env åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œä¸åº”æ‹·è´ |
| **æœ€ä½³å®è·µ** | ç‹¬ç«‹ CLI åŒ… + ç”¨æˆ·çº§é…ç½® |
